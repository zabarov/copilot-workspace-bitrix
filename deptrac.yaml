deptrac:
  parameters:
    module_id: __MODULE_ID__

  paths:
    - local/modules/%module_id%/lib

  layers:
    - name: Core
      collectors:
        - type: directory
          regex: '^local/modules/%module_id%/lib/Core/.*'
    - name: Domain
      collectors:
        - type: directory
          regex: '^local/modules/%module_id%/lib/Domain/(?!Port/).*'
    - name: Ports
      collectors:
        - type: directory
          regex: '^local/modules/%module_id%/lib/Domain/Port/.*'
    - name: Diagnostics
      collectors:
        - type: directory
          regex: '^local/modules/%module_id%/lib/Diagnostics/.*'
    - name: Adapter_Bitrix
      collectors:
        - type: directory
          regex: '^local/modules/%module_id%/lib/Adapter/Bitrix/.*'

  ruleset:
    Core: ~
    Domain:
      - Core
    Ports:
      - Core
      - Domain
    Diagnostics:
      - Core
      - Domain
      - Ports
    Adapter_Bitrix:
      - Core
      - Domain
      - Ports
