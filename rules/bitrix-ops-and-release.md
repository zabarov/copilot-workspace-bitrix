# Окружение, интеграции и релизы (1С-Битрикс)

Требования к установке, сопровождению, релизам и публикации решений на основе материалов учебных курсов (Установка, BitrixVM, Многосайтовость, Маркетплейс, Интеграция с 1С, Высоконагруженные проекты).

## Окружение и установка
- Поддерживайте актуальные версии PHP/MySQL/NGINX/Apache в рамках матрицы поддержки Bitrix; настраивайте таймзону и кодировку UTF-8.
- Используйте BitrixVM или аналогичные шаблоны с преднастройками (web-сервер, PHP-FPM, кеширование, почта).
- Не изменяйте ядро `/bitrix/`; все доработки — в `local/`.
- Подключайте пролог/эпилог на публичных/админ-страницах; защищайте включения `B_PROLOG_INCLUDED`.
- Настройте отправку почты и логирование ошибок, включите отображение ошибок только на стендах разработки.

## Многосайтовость и конфигурация
- Разделяйте `SITE_ID`, `SITE_DIR`, домены; не хардкодьте URL.
- Конфигурацию окружения выносите в `.settings.php`/`.settings_extra.php` с разделением стендов (dev/test/prod).
- При клонировании проектов на новый домен обновляйте ссылки, индексы поиска, карты сайта, кеш.

## Интеграции (1С/REST/обмены)
- Интеграции с 1С: используйте типовые обмены, логируйте ошибки и статистику обменов; валидируйте входящие данные; не допускайте «тихих» падений.
- REST/вебхуки (Битрикс24): проверяйте токены/подписи, ограничивайте частоту запросов, обрабатывайте HTTP-ошибки и таймауты, логируйте.
- Для файлов/данных из интеграций применяйте фильтрацию и проверку типов, не пишите в веб-доступные директории без необходимости.

## Релизы, обновления, маркетплейс
- Модульные релизы: версионирование в `install/version.php`, хронология изменений, README в релизных пакетах.
- Обновления: пакет должен содержать полное дерево модуля в `install/local/modules/<module_id>/...`, актуальный `install/version.php` и рабочий `updater.php` (копирование в точные пути, проверки модуля/прав, защита от прямого вызова).
- Описание обновления (`description.ru`) включает диапазон релиза, ключевые изменения, требования и инструкцию по установке.
- Для Маркетплейса: не трогайте ядро, используйте префикс `local/`, не прошивайте ключи/URL, соблюдайте требования к версиям PHP/БД, готовьте документацию и скриншоты; проверяйте права при установке/удалении.

## Бэкапы, мониторинг, эксплуатация
- Делайте регулярные бэкапы БД и файлов, проверяйте восстановление; храните бэкапы вне боевого сервера.
- Включите мониторинг производительности и ошибок (время ответа, RPS, PHP errors, webserver logs, очереди агентов/cron).
- Агентам и cron-задачам задавайте разумную частоту, не выполняйте тяжёлые задачи в веб-процессе.

## Индексация, поиск, контент
- Поддерживайте индексацию сайта (поисковый модуль), обновляйте карту сайта при изменении структуры.
- При работе с инфоблоками и контентом проверяйте права доступа, не публикуйте скрытый контент через кеш/композит.

## Документация и учебные материалы
- Любые пользовательские/админ-инструкции, обучающие страницы оформляйте с учётом правил форматирования (подсказки, спойлеры, вкладки, предупреждения) из курсов.
- Поддерживайте согласованность между кодом, настройками и документацией: обновляйте `docs/` и описания в релизах/обновлениях.
